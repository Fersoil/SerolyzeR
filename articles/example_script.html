<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic PvSTATEM functionalities • PvSTATEM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic PvSTATEM functionalities">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PvSTATEM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example_script.html">Basic PvSTATEM functionalities</a>
    </li>
    <li>
      <a href="../articles/our_datasets.html">Our datasets</a>
    </li>
    <li>
      <a href="../articles/our_plots.html">Quick introduction to plots created by our package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mini-pw/PvSTATEM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic PvSTATEM functionalities</h1>
                        <h4 data-toc-skip class="author">Tymoteusz
Kwieciński</h4>
            
            <h4 data-toc-skip class="date">2024-09-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mini-pw/PvSTATEM/blob/main/vignettes/example_script.Rmd" class="external-link"><code>vignettes/example_script.Rmd</code></a></small>
      <div class="hidden name"><code>example_script.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The basic functionality of the <code>PvSTATEM</code> package is
reading raw MBA data. To present the package’s functionalities, we use a
sample dataset from the Covid OISE study, which is pre-loaded into the
package. You might want to replace these variables with paths to your
files on your local disk. Firstly, let us load the dataset as the
<code>plate</code> object.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mini-pw/PvSTATEM" class="external-link">PvSTATEM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plate_filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT.csv"</span>, package <span class="op">=</span> <span class="st">"PvSTATEM"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># get the filepath of the csv dataset</span></span>
<span></span>
<span><span class="va">layout_filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT_layout.xlsx"</span>, package <span class="op">=</span> <span class="st">"PvSTATEM"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">plate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_luminex_data.html">read_luminex_data</a></span><span class="op">(</span><span class="va">plate_filepath</span>, <span class="va">layout_filepath</span><span class="op">)</span> <span class="co"># read the data</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/PvSTATEM/extdata/CovidOISExPONTENT.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: CovidOISExPONTENT!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plate</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Plate with 96 samples and 30 analytes</span></span></code></pre>
<p>After the plate is successfully loaded, we can look at some basic
information about it.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plate</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Summary of the plate with name 'CovidOISExPONTENT':</span></span>
<span><span class="co">#&gt; Total number of samples: 96</span></span>
<span><span class="co">#&gt; Number of blank samples: 1</span></span>
<span><span class="co">#&gt; Number of standard curve samples: 11</span></span>
<span><span class="co">#&gt; Number of positive control samples: 0</span></span>
<span><span class="co">#&gt; Number of negative control samples: 0</span></span>
<span><span class="co">#&gt; Number of test samples: 84</span></span>
<span><span class="co">#&gt; Number of analytes: 30</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plate</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>include_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># more detailed summary</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Summary of the plate with name 'CovidOISExPONTENT':</span></span>
<span><span class="co">#&gt; Total number of samples: 96</span></span>
<span><span class="co">#&gt; Number of blank samples: 1</span></span>
<span><span class="co">#&gt; Number of standard curve samples: 11</span></span>
<span><span class="co">#&gt; Sample names: '1/50', '1/100', '1/200', '1/400', '1/800', '1/1600', '1/3200', '1/6400', '1/12800', '1/25600', '1/102400'</span></span>
<span><span class="co">#&gt; Number of positive control samples: 0</span></span>
<span><span class="co">#&gt; Number of negative control samples: 0</span></span>
<span><span class="co">#&gt; Number of test samples: 84</span></span>
<span><span class="co">#&gt; Number of analytes: 30</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plate</span><span class="op">$</span><span class="va">sample_names</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  [1] "B"              "1/50"           "1/100"          "1/200"         </span></span>
<span><span class="co">#&gt;  [5] "1/400"          "1/800"          "1/1600"         "1/3200"        </span></span>
<span><span class="co">#&gt;  [9] "1/6400"         "1/12800"        "1/25600"        "1/102400"      </span></span>
<span><span class="co">#&gt; [13] "CO-F-226-01-CF" "CO-F-263-02-KC" "CO-F-080-02-TV" "CO-F-215-01-BA"</span></span>
<span><span class="co">#&gt; [17] "CO-H-SD-039-BC" "CO-H-RD-053-MO" "CO-F-030-01-LA" "CO-F-204-01-TC"</span></span>
<span><span class="co">#&gt; [21] "CO-F-009-01-CS" "CO-F-156-02-GB" "CO-F-402-03-DE" "CO-H-SK-021-BC"</span></span>
<span><span class="co">#&gt; [25] "CO-F-226-02-CM" "CO-F-266-01-LC" "CO-F-080-03-TA" "CO-F-215-02-BN"</span></span>
<span><span class="co">#&gt; [29] "CO-H-SD-042-DD" "CO-H-RK-002-BA" "CO-F-031-01-LD" "CO-F-204-02-TT"</span></span>
<span><span class="co">#&gt; [33] "CO-F-021-03-DF" "CO-F-156-03-GN" "CO-F-402-04-DR" "CO-H-SK-023-DC"</span></span>
<span><span class="co">#&gt; [37] "CO-F-226-03-CG" "CO-F-272-01-DF" "CO-F-080-04-TM" "CO-F-215-03-BA"</span></span>
<span><span class="co">#&gt; [41] "CO-H-SK-004-GA" "CO-H-RK-004-WN" "CO-F-112-01-CN" "CO-F-220-01-VV"</span></span>
<span><span class="co">#&gt; [45] "CO-F-028-01-PJ" "CO-F-214-01-SP" "CO-F-402-05-DS" "CO-H-SK-029-LC"</span></span>
<span><span class="co">#&gt; [49] "CO-F-234-01-LC" "CO-F-310-01-DC" "CO-F-082-01-OF" "CO-F-299-01-CS"</span></span>
<span><span class="co">#&gt; [53] "CO-H-SK-006-MS" "CO-H-RK-007-CJ" "CO-F-180-01-PN" "CO-F-243-01-BL"</span></span>
<span><span class="co">#&gt; [57] "CO-F-124-01-SV" "CO-F-237-01-LE" "CO-H-SD-002-WL" "CO-H-SK-030-MJ"</span></span>
<span><span class="co">#&gt; [61] "CO-F-234-02-LS" "CO-F-311-01-PC" "CO-F-089-01-DP" "CO-F-325-01-LN"</span></span>
<span><span class="co">#&gt; [65] "CO-H-SK-011-CC" "CO-H-RK-009-MB" "CO-F-180-02-DM" "CO-F-243-02-SH"</span></span>
<span><span class="co">#&gt; [69] "CO-F-134-01-MK" "CO-F-281-01-BV" "CO-H-SD-013-LV" "CO-H-SK-031-CP"</span></span>
<span><span class="co">#&gt; [73] "CO-F-260-01-GD" "CO-F-075-01-BA" "CO-F-089-02-DC" "CO-H-SD-004-CG"</span></span>
<span><span class="co">#&gt; [77] "CO-H-SK-051-DA" "CO-H-RK-010-VP" "CO-F-180-03-DR" "CO-F-276-01-ME"</span></span>
<span><span class="co">#&gt; [81] "CO-F-134-02-GM" "CO-F-402-01-BH" "CO-H-SD-043-BS" "CO-H-SK-039-AA"</span></span>
<span><span class="co">#&gt; [85] "CO-F-260-02-GC" "CO-F-075-02-FM" "CO-F-139-01-BP" "CO-H-SD-021-PC"</span></span>
<span><span class="co">#&gt; [89] "CO-H-SK-056-MN" "CO-F-027-02-SL" "CO-F-180-04-DC" "CO-F-027-01-SF"</span></span>
<span><span class="co">#&gt; [93] "CO-F-156-01-GA" "CO-F-402-02-DV" "CO-H-SK-018-VC" "CO-F-045-01-SN"</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plate</span><span class="op">$</span><span class="va">analyte_names</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  [1] "Spike_6P"      "ME"            "HKU1_S"        "OC43_NP"      </span></span>
<span><span class="co">#&gt;  [5] "OC43_S"        "HKU1_NP"       "X229E_NP"      "Mumps_NP"     </span></span>
<span><span class="co">#&gt;  [9] "RBD_B16171"    "NL63_NP"       "RBD_B16172"    "RBD_wuhan"    </span></span>
<span><span class="co">#&gt; [13] "NL63_S"        "X229E_S"       "Spike_B16172"  "Spike_B117"   </span></span>
<span><span class="co">#&gt; [17] "Measles_NP"    "Ade5"          "NP"            "Spike_P1"     </span></span>
<span><span class="co">#&gt; [21] "Rub"           "Ade40"         "RBD_B117"      "Spike_B1351"  </span></span>
<span><span class="co">#&gt; [25] "FluA"          "RBD_B1351"     "RBD_P15"       "S2"           </span></span>
<span><span class="co">#&gt; [29] "Spike_omicron" "RBD_omicron"</span></span></code></pre>
<p>The summary can also be accessed using the built-in generic method
<code>summary</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">plate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Summary of the plate with name 'CovidOISExPONTENT':</span></span>
<span><span class="co">#&gt; Total number of samples: 96</span></span>
<span><span class="co">#&gt; Number of blank samples: 1</span></span>
<span><span class="co">#&gt; Number of standard curve samples: 11</span></span>
<span><span class="co">#&gt; Number of positive control samples: 0</span></span>
<span><span class="co">#&gt; Number of negative control samples: 0</span></span>
<span><span class="co">#&gt; Number of test samples: 84</span></span>
<span><span class="co">#&gt; Number of analytes: 30</span></span></code></pre>
<div class="section level3">
<h3 id="quality-control">Quality control<a class="anchor" aria-label="anchor" href="#quality-control"></a>
</h3>
<p>The package can plot the dilutions along the MFI values, allowing
manual inspection of the standard curve. This method raises a warning in
case the MFI values were not adjusted using the blank samples.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_analyte.html">plot_standard_curve_analyte</a></span><span class="op">(</span><span class="va">plate</span>, analyte_name <span class="op">=</span> <span class="st">"OC43_S"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_script_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plate</span><span class="op">$</span><span class="fu">blank_adjustment</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Plate with 96 samples and 30 analytes</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plate</span><span class="op">$</span><span class="va">blank_adjusted</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_analyte.html">plot_standard_curve_analyte</a></span><span class="op">(</span><span class="va">plate</span>, analyte_name <span class="op">=</span> <span class="st">"OC43_S"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_script_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<p>We can also plot the standard curve for different analytes and data
types. A list of all available analytes on the plate can be accessed
using the command <code>plate$analyte_names</code>.</p>
<p>By default, all the operations are performed on the
<code>Median</code> value of the samples; this option can be selected
from the <code>data_type</code> parameter of the function.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_analyte.html">plot_standard_curve_analyte</a></span><span class="op">(</span><span class="va">plate</span>, analyte_name <span class="op">=</span> <span class="st">"RBD_wuhan"</span>, data_type <span class="op">=</span> <span class="st">"Mean"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_script_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_analyte.html">plot_standard_curve_analyte</a></span><span class="op">(</span><span class="va">plate</span>, analyte_name <span class="op">=</span> <span class="st">"RBD_wuhan"</span>, data_type <span class="op">=</span> <span class="st">"Avg Net MFI"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_script_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<p>This plot may be used to assess the quality of the standard curve and
anticipate some of the potential issues with the data. For instance, if
we plotted the standard curve for the analyte <code>ME</code> we could
notice that the <code>Median</code> value of sample with dilution of
<code>1/25600</code> is abnormally large, which may indicate a problem
with the data.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_analyte.html">plot_standard_curve_analyte</a></span><span class="op">(</span><span class="va">plate</span>, analyte_name <span class="op">=</span> <span class="st">"ME"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_script_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_analyte.html">plot_standard_curve_analyte</a></span><span class="op">(</span><span class="va">plate</span>, analyte_name <span class="op">=</span> <span class="st">"ME"</span>, log_scale <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_script_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<p>The plotting function has more options, such as selecting which axis
the log scale should be applied or reversing the curve. More detailed
information can be found in the function documentation, accessed by
executing the command <code><a href="../reference/plot_standard_curve_analyte.html">?plot_standard_curve_analyte</a></code>.</p>
<p>Another useful method of inspecting the potential errors of the data
is <code>plot_mfi_for_analyte</code>. This method plots the MFI values
of standard curve samples for a given analyte along the boxplot of the
MFI values of the test samples.</p>
<p>It helps identify the outlier samples and check if the test samples
are within the range of the standard curve samples.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mfi_for_analyte.html">plot_mfi_for_analyte</a></span><span class="op">(</span><span class="va">plate</span>, analyte_name <span class="op">=</span> <span class="st">"OC43_S"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_script_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mfi_for_analyte.html">plot_mfi_for_analyte</a></span><span class="op">(</span><span class="va">plate</span>, analyte_name <span class="op">=</span> <span class="st">"Spike_6P"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_script_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<p>It can be seen that for the <code>Spike_6P</code> analyte, the MFI
values don’t fall within the range of the standard curve samples, which
could be problematic for the model. The values of test dilutions will be
extrapolated from the standard curve, which may lead to incorrect
results.</p>
</div>
<div class="section level3">
<h3 id="normalization">Normalization<a class="anchor" aria-label="anchor" href="#normalization"></a>
</h3>
<p>After inspection, we may create the model for the standard curve of a
certain antibody. The model is fitted using the <code>nplr</code>
package, which provides a simple interface for fitting n-parameter
logistic regression models, but to create a clearer interface for the
user, we encapsulated this model into our own class called
<code>Model</code> for simplicity. The detailed documentation of the
<code>Model</code> class can be found by executing the command
<code><a href="../reference/Model.html">?Model</a></code>.</p>
<p>The model is then used to predict the dilutions of the samples based
on the MFI values.</p>
<p><code>nplr</code> package fits the model using the formula:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>B</mi><mo>+</mo><mfrac><mrow><mi>T</mi><mo>−</mo><mi>B</mi></mrow><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>+</mo><msup><mn>10</mn><mrow><mi>b</mi><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow></msub><mo>−</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow><mi>s</mi></msup></mfrac></mrow><annotation encoding="application/x-tex"> y = B + \frac{T - B}{[1 + 10^{b \cdot (x_{mid} - x)}]^s} </annotation></semantics></math></p>
<p>Where:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
is the predicted value, MFI in our case,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
is the independent variable, dilution in our case,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
is the bottom plateau - the right horizontal asymptote,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
is the top plateau - the left horizontal asymptote,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
is the slope of the curve at the inflection point,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">x_{mid}</annotation></semantics></math>
is x-coordinate at the inflection point,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
is the asymmetric coefficient.</p></li>
</ul>
<p>This equation is referred to as the Richards’ equation. More
information about the model can be found in the <code>nplr</code>
package documentation.</p>
<p>By default, the <code>nplr</code> model transforms the x values using
the log10 function.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_standard_curve_model_analyte.html">create_standard_curve_model_analyte</a></span><span class="op">(</span><span class="va">plate</span>, analyte_name <span class="op">=</span> <span class="st">"OC43_S"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Instance of the Model class fitted for analyte ' OC43_S ': </span></span>
<span><span class="co">#&gt;  - fitted with 5 parameters</span></span>
<span><span class="co">#&gt;  - using 11 samples</span></span>
<span><span class="co">#&gt;  - using log residuals (mfi):  TRUE </span></span>
<span><span class="co">#&gt;  - using log dilution:  TRUE </span></span>
<span><span class="co">#&gt;  - top asymptote: 28414.96 </span></span>
<span><span class="co">#&gt;  - bottom asymptote: 38.60885 </span></span>
<span><span class="co">#&gt;  - goodness of fit: 0.9970645 </span></span>
<span><span class="co">#&gt;  - weighted goodness of fit: 0.9998947</span></span></code></pre>
<p>Since our <code>model</code> object contains all the characteristics
and parameters of the fitted regression model. The model can be used to
predict the dilutions of the samples based on the MFI values. The output
above shows the most important parameters of the fitted model.</p>
<p>The predicted values may be used to plot the standard curve, which
can be compared to the sample values.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_analyte_with_model.html">plot_standard_curve_analyte_with_model</a></span><span class="op">(</span><span class="va">plate</span>, <span class="va">model</span>, log_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_script_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_analyte_with_model.html">plot_standard_curve_analyte_with_model</a></span><span class="op">(</span><span class="va">plate</span>, <span class="va">model</span>, log_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span><span class="op">)</span>, plot_asymptote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_script_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<p>Apart from the plotting, the package can predict the values of all
the samples on the plate.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mfi_values</span> <span class="op">&lt;-</span> <span class="va">plate</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">Median</span><span class="op">$</span><span class="va">OC43_S</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mfi_values</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1]   43.0 4193.0 1982.0 1308.0  681.0  365.5</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predicted_dilutions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">mfi_values</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predicted_dilutions</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;      MFI     dilution.025       dilution dilution.975</span></span>
<span><span class="co">#&gt; 1   43.0 0.00000005558992 0.000002375258 0.0000116848</span></span>
<span><span class="co">#&gt; 2 4193.0 0.01714585144143 0.020682014649 0.0250660657</span></span>
<span><span class="co">#&gt; 3 1982.0 0.00706247182542 0.008326658518 0.0097229242</span></span>
<span><span class="co">#&gt; 4 1308.0 0.00449295780123 0.005240371360 0.0061418307</span></span>
<span><span class="co">#&gt; 5  681.0 0.00217917789255 0.002556577252 0.0030023282</span></span>
<span><span class="co">#&gt; 6  365.5 0.00104105587691 0.001242668884 0.0014687246</span></span></code></pre>
<p>The dataframe contains original MFI values and the predicted
dilutions based on the model. Since the dilution values are obtained by
reversing the logistic model formula, the predictions also include the
confidence intervals for the dilutions. The interval is represented as
its upper and bottom bounds, which are stored in columns
<code>dilution.025</code> and <code>dilution.975</code>,
respectively.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tymoteusz Kwiecinski, Jakub Grzywaczewski, Mateusz Nizwantowski.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
