<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick introduction to plots created by our package • PvSTATEM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quick introduction to plots created by our package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PvSTATEM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example_script.html">Basic PvSTATEM functionalities</a>
    </li>
    <li>
      <a href="../articles/our_datasets.html">Our datasets</a>
    </li>
    <li>
      <a href="../articles/our_plots.html">Quick introduction to plots created by our package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mini-pw/PvSTATEM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quick introduction to plots created by our
package</h1>
                        <h4 data-toc-skip class="author">Mateusz
Nizwantowski</h4>
            
            <h4 data-toc-skip class="date">2024-09-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mini-pw/PvSTATEM/blob/main/vignettes/our_plots.Rmd" class="external-link"><code>vignettes/our_plots.Rmd</code></a></small>
      <div class="hidden name"><code>our_plots.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>PvSTATEM</code> package provides a variety of plots that
can be used to visualize the Luminex data. In this vignette, we will
show how to use them. To present the package’s functionalities, we use a
sample dataset from the Covid OISE study, which is pre-loaded into the
package. Firstly, let us load the dataset as the <code>plate</code>
object.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mini-pw/PvSTATEM" class="external-link">PvSTATEM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plate_filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT.csv"</span>, package <span class="op">=</span> <span class="st">"PvSTATEM"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># get the filepath of the csv dataset</span></span>
<span></span>
<span><span class="va">layout_filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT_layout.xlsx"</span>, package <span class="op">=</span> <span class="st">"PvSTATEM"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">plate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_luminex_data.html">read_luminex_data</a></span><span class="op">(</span><span class="va">plate_filepath</span>, <span class="va">layout_filepath</span><span class="op">)</span> <span class="co"># read the data</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/PvSTATEM/extdata/CovidOISExPONTENT.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: CovidOISExPONTENT!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plate</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Plate with 96 samples and 30 analytes</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="plate-layout">Plate layout<a class="anchor" aria-label="anchor" href="#plate-layout"></a>
</h2>
<p>In this vignette, we will omit some validation functionality and
focus on the plots. After the plate is successfully loaded, we should
validate it by looking at some basic information about it using the
summary function. However, we can also obtain similar information in a
more visual way by using the <code>plot_layout</code> function. It helps
to quickly asses whether the layout of the plate is correctly read from
Luminex or the layout file. The function takes the <code>plate</code>
object as the argument.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_layout.html">plot_layout</a></span><span class="op">(</span><span class="va">plate</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>The plot above shows the layout of the plate. The wells are colored
according to the type of the sample. If the user is familiar with the
color scheme of this package, there is an option to turn off the legend.
This can be done by setting <code>show_legend</code> parameter to
<code>FALSE</code>.</p>
<p>If the plot window is resized, it is recommended that the function be
rerun to adjust the scaling of the plot. Sometimes, the whole layout may
be shifted when a legend is plotted. To solve this issue, one has to
stretch the window in the direction of the layout shift, and everything
will be adjusted automatically.</p>
</div>
<div class="section level2">
<h2 id="counts-for-a-given-analyte">Counts for a given analyte<a class="anchor" aria-label="anchor" href="#counts-for-a-given-analyte"></a>
</h2>
<p>The <code>plot_counts</code> function allows us to visualize the
counts of the analyte in the plate. This plot is useful for quickly
spotting wells with a count that is too low. The function takes the
<code>plate</code> object and the analyte name as the arguments. The
function will return an error message if there is a typo in the analyte
name.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_counts.html">plot_counts</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"Spike_B16172"</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>The plot above shows the counts of the analyte “OC43_NP_NA” in the
plate. The wells are colored according to the count of the analyte.
Too-low values are marked with red, values on the edge of the threshold
are marked with yellow, and the rest are marked with green. There is an
option to show legend by setting <code>show_legend</code> parameter to
<code>TRUE</code>. There is also an option to show just the colors
without the counts by setting <code>show_counts</code> parameter to
<code>FALSE</code>. This provides a cleaner plot without the counts.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_counts.html">plot_counts</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"FluA"</span>, plot_counts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="distribution-of-mfi-values">Distribution of MFI values<a class="anchor" aria-label="anchor" href="#distribution-of-mfi-values"></a>
</h2>
<p>The <code>plot_mfi_distribution</code> function allows us to
visualize the distribution of the MFI values for test samples for the
given analyte. And how they compare to standard curve samples on a given
plate. This plot is helpful to asses if the standard curve samples cover
the whole range of MFI of test samples. The function takes the
<code>plate</code> object and the analyte name as the arguments. The
function will return an error message if there is a typo in the analyte
name.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mfi_for_analyte.html">plot_mfi_for_analyte</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"Spike_B16172"</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>This plot shows the distribution of the MFI values for test samples
for the analyte “OC43_NP_NA”. The test samples are colored in blue, and
the standard curve samples are colored in red. The default plot type is
boxplot, but there is an option to change it to violin plot by setting
the <code>plot_type</code> parameter to <code>violin</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mfi_for_analyte.html">plot_mfi_for_analyte</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"FluA"</span>, plot_type <span class="op">=</span> <span class="st">"violin"</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="standard-curve-plots">Standard curve plots<a class="anchor" aria-label="anchor" href="#standard-curve-plots"></a>
</h2>
<p>Finally, we arrive at the most important visualization in our package
- the standard curve related plots. Those plots help assess the quality
of the fit, which will be crucial to us in the next step of package
development. It comes in two flavors:
<code>plot_standard_curve_analyte</code> and
<code>plot_standard_curve_analyte_with_model</code>. The first does not
incorporate the model, while the second does.</p>
<div class="section level3">
<h3 id="standard-curve-plot-without-model">Standard curve plot without model<a class="anchor" aria-label="anchor" href="#standard-curve-plot-without-model"></a>
</h3>
<p>This plot should be used to assess the quality of the assay. If
anything goes wrong during the plate preparation, it should be visible
easily in this plot.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_analyte.html">plot_standard_curve_analyte</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"Spike_B16172"</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Above, we see the default plot for the analyte “Spike_B16172”. We can
modify this plot by setting the parameters of the function. For example,
we can change the direction of the x-axis by setting
<code>decreasing_dilution_order</code> parameter to <code>FALSE</code>.
Other parameters worth mentioning are <code>log_scale</code>, the
default value is <code>c("all")</code>, which means that both the x and
y axes are in the log scale. Other possible values for this parameter
are <code>c("dilutions")</code> and <code>c("MFI")</code>, which means
that only the x or y axis is in the log scale. There is also an option
to turn off some parts of the plot by setting parameters
<code>plot_line</code>, <code>plot_blank_mean</code> and
<code>plot_dilution_bounds</code> to <code>FALSE</code>. The first
disables drawing the line between standard curve points, the second
turns off plotting the mean of blank samples, and the last disables
plotting the dilution bounds.</p>
</div>
<div class="section level3">
<h3 id="standard-curve-plot-with-model">Standard curve plot with model<a class="anchor" aria-label="anchor" href="#standard-curve-plot-with-model"></a>
</h3>
<p>This visualization is similar to the previous one but also
incorporates the model. Thus, it carries more information at the cost of
being more complex and crowded.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_standard_curve_model_analyte.html">create_standard_curve_model_analyte</a></span><span class="op">(</span><span class="va">plate</span>, analyte_name <span class="op">=</span> <span class="st">"Spike_B16172"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_standard_curve_analyte_with_model.html">plot_standard_curve_analyte_with_model</a></span><span class="op">(</span><span class="va">plate</span>, <span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Here, we do not have to specify the analyte name, as the model
already carries this information. The model is created by the
<code>create_standard_curve_model_analyte</code> function, which takes
the <code>plate</code> object and the analyte name as the arguments, but
this is not the focus of this vignette. The arguments of this function
are very similar to the previous one, except here there is a missing
<code>plot_line' argument, and there are two new arguments:</code>plot_asymptote<code>and</code>plot_test_predictions<code>. The first turns off plotting the asymptotes, and the second disables plotting the test samples' predictions. By default, both are set to</code>TRUE`.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tymoteusz Kwiecinski, Jakub Grzywaczewski, Mateusz Nizwantowski.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
