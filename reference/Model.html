<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Logisic regresion model for the standard curve — Model • PvSTATEM</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Logisic regresion model for the standard curve — Model"><meta property="og:description" content="This model uses the nplr package to fit the model. The model is fitted using the formula:
$$y = B + \frac{T - B}{(1 + 10^{b \cdot (x_{mid} - x)})^s},$$
where:
\(y\) is the predicted value, MFI in our case,
\(x\) is the independent variable, dilution in our case,
\(B\) is the bottom plateau - the right horizontal asymptote,
\(T\) is the top plateau - the left horizontal asymptote,
\(b\) is the slope of the curve at the inflection point,
\(x_{mid}\) is the x-coordinate at the inflection point,
\(s\) is the asymmetric coefficient.


This equation is refereed as the Richards' equation. More information about the model can be found in the nplr package documentation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PvSTATEM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/example_script.html">Basic PvSTATEM functionalities</a>
    </li>
    <li>
      <a href="../articles/our_datasets.html">Our datasets</a>
    </li>
    <li>
      <a href="../articles/our_plots.html">Quick introduction to plots created by our package</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mini-pw/PvSTATEM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Logisic regresion model for the standard curve</h1>
    <small class="dont-index">Source: <a href="https://github.com/mini-pw/PvSTATEM/blob/main/R/classes-model.R" class="external-link"><code>R/classes-model.R</code></a></small>
    <div class="hidden name"><code>Model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This model uses the <code>nplr</code> package to fit the model. The model is fitted using the formula:</p>
<p>$$y = B + \frac{T - B}{(1 + 10^{b \cdot (x_{mid} - x)})^s},$$</p>
<p>where:</p><ul><li><p>\(y\) is the predicted value, MFI in our case,</p></li>
<li><p>\(x\) is the independent variable, dilution in our case,</p></li>
<li><p>\(B\) is the bottom plateau - the right horizontal asymptote,</p></li>
<li><p>\(T\) is the top plateau - the left horizontal asymptote,</p></li>
<li><p>\(b\) is the slope of the curve at the inflection point,</p></li>
<li><p>\(x_{mid}\) is the x-coordinate at the inflection point,</p></li>
<li><p>\(s\) is the asymmetric coefficient.</p></li>
</ul><p>This equation is refereed as the Richards' equation. More information about the model can be found in the <code>nplr</code> package documentation.</p>
    </div>


    <div id="public-fields">
    <h2>Public fields</h2>
    <p></p><div class="r6-fields"><dl><dt><code>analyte</code></dt>
<dd><p>(<code>character(1)</code>)<br>
Name of the analyte for which the model was fitted</p></dd>


<dt><code>dilutions</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>)<br>
Dilutions used to fit the model</p></dd>


<dt><code>mfi</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>)<br>
MFI values used to fit the model</p></dd>


<dt><code>mfi_min</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
Minimum MFI used for scaling MFI values to the range [0, 1]</p></dd>


<dt><code>mfi_max</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
Maximum MFI used for scaling MFI values to the range [0, 1]</p></dd>


<dt><code>model</code></dt>
<dd><p>(<code>nplr</code>)<br>
Instance of the <code>nplr</code> model fitted to the data</p></dd>


<dt><code>log_dilution</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>)<br>
Indicator should the dilutions be transformed using the <code>log10</code> function</p></dd>


<dt><code>log_mfi</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>)<br>
Indicator should the MFI values be transformed using the <code>log10</code> function</p></dd>


<dt><code>scale_mfi</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>)<br>
Indicator should the MFI values be scaled to the range [0, 1]</p></dd>


</dl><p></p></div>
    </div>
    <div id="active-bindings">
    <h2>Active bindings</h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>top_asymptote</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
The top asymptote of the logistic curve</p></dd>


<dt><code>bottom_asymptote</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
The bottom asymptote of the logistic curve</p></dd>


</dl><p></p></div>
    </div>
    <div id="methods">
    <h2>Methods</h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-Model-new"><code>Model$new()</code></a></p></li>
<li><p><a href="#method-Model-predict"><code>Model$predict()</code></a></p></li>
<li><p><a href="#method-Model-get_plot_data"><code>Model$get_plot_data()</code></a></p></li>
<li><p><a href="#method-Model-print"><code>Model$print()</code></a></p></li>
<li><p><a href="#method-Model-clone"><code>Model$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-Model-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a new instance of Model <a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6</a> class</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/Model.html">Model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">analyte</span>,</span>
<span>  <span class="va">dilutions</span>,</span>
<span>  <span class="va">mfi</span>,</span>
<span>  npars <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  log_dilution <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  log_mfi <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale_mfi <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mfi_min <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mfi_max <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>analyte</code></dt>
<dd><p>(<code>character(1)</code>)<br>
Name of the analyte for which the model was fitted.</p></dd>


<dt><code>dilutions</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>)<br>
Dilutions used to fit the model</p></dd>


<dt><code>mfi</code></dt>
<dd><p>MFI (<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>)<br>
values used to fit the model</p></dd>


<dt><code>npars</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
Number of parameters to use in the model</p></dd>


<dt><code>verbose</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>)<br>
If <code>TRUE</code> prints messages, <code>TRUE</code> by default</p></dd>


<dt><code>log_dilution</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>)<br>
If <code>TRUE</code> the dilutions are transformed using the <code>log10</code> function, <code>TRUE</code> by default</p></dd>


<dt><code>log_mfi</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>)<br>
If <code>TRUE</code> the MFI values are transformed using the <code>log10</code> function, <code>TRUE</code> by default</p></dd>


<dt><code>scale_mfi</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical()</a></code>)<br>
If <code>TRUE</code> the MFI values are scaled to the range [0, 1], <code>TRUE</code> by default</p></dd>


<dt><code>mfi_min</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
Enables to set the minimum MFI value used for scaling MFI values to the range [0, 1].
Use a values before any transformations (e.g. before the <code>log10</code> transformation)</p></dd>


<dt><code>mfi_max</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
Enables to set the maximum MFI value used for scaling MFI values to the range [0, 1].
Use a values before any transformations (e.g. before the <code>log10</code> transformation)</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Model-predict"></a><div class="section">
<h3 id="method-predict-">Method <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code><a class="anchor" aria-label="anchor" href="#method-predict-"></a></h3>
<p>Predict the dilutions from the MFI values</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Model</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">mfi</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>mfi</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>)<br>
MFI values for which we want to predict the dilutions.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>(<code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code>)<br>
Dataframe with the predicted dilutions, MFI values and the 97.5% confidence intervals
The columns are named as follows:</p><ul><li><p><code>dilution</code> - the dilution value</p></li>
<li><p><code>dilution.025</code> - the lower bound of the confidence interval</p></li>
<li><p><code>dilution.975</code> - the upper bound of the confidence interval</p></li>
<li><p><code>MFI</code> - the predicted MFI value</p></li>
</ul></div>

</div><p></p><hr><a id="method-Model-get_plot_data"></a><div class="section">
<h3 id="method-get-plot-data-">Method <code>get_plot_data()</code><a class="anchor" aria-label="anchor" href="#method-get-plot-data-"></a></h3>
<p>Data that can be used to plot the standard curve.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Model</span><span class="op">$</span><span class="fu">get_plot_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>(<code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code>)<br>
Prediction dataframe for scaled MFI (or logMFI) values in the range [0, 1].
Columns are named as in the <code>predict</code> method</p>
</div>

</div><p></p><hr><a id="method-Model-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Function prints the basic information about the model
such as the number of parameters or samples used</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Model</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Model-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Model</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">plate_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT.csv"</span>, package <span class="op">=</span> <span class="st">"PvSTATEM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">layout_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT_layout.csv"</span>, package <span class="op">=</span> <span class="st">"PvSTATEM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plate</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_luminex_data.html">read_luminex_data</a></span><span class="op">(</span><span class="va">plate_file</span>, layout_filepath <span class="op">=</span> <span class="va">layout_file</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading Luminex data from: /home/runner/work/_temp/Library/PvSTATEM/extdata/CovidOISExPONTENT.csv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> using format xPONENT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">New plate object has been created with name: CovidOISExPONTENT!</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_standard_curve_model_analyte.html">create_standard_curve_model_analyte</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"S2"</span>, log_mfi <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Instance of the Model class fitted for analyte ' S2 ': </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - fitted with 5 parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - using 11 samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - using log residuals (mfi):  TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - using log dilution:  TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - top asymptote: 6587.765 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - bottom asymptote: 24.6534 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - goodness of fit: 0.996416 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - weighted goodness of fit: 0.9998704 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tymoteusz Kwiecinski, Jakub Grzywaczewski, Mateusz Nizwantowski.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

