<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate normalised MFI values for a plate — get_nmfi • PvSTATEM</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate normalised MFI values for a plate — get_nmfi"><meta name="description" content="The function calculates the normalised MFI (nMFI) values for each of the analytes in the plate.
The nMFI values are calculated as the ratio of the test samples' MFI values to the standard curve samples with the target dilution.
When nMFI could be used?
In general, it is preferred to use Relative Antibody Unit (RAU) values for any analysis.
However, it is sometimes impossible to fit a model to the standard curve samples.
This may happen if the MFI values of test samples are much higher than the MFI of standard curve samples.
Then, the prediction would require significant data extrapolation, which could lead to unreliable results.
In such cases, the nMFI values could be used as a proxy for RAU values if we want, for instance, to account for plate-to-plate variation."><meta property="og:description" content="The function calculates the normalised MFI (nMFI) values for each of the analytes in the plate.
The nMFI values are calculated as the ratio of the test samples' MFI values to the standard curve samples with the target dilution.
When nMFI could be used?
In general, it is preferred to use Relative Antibody Unit (RAU) values for any analysis.
However, it is sometimes impossible to fit a model to the standard curve samples.
This may happen if the MFI values of test samples are much higher than the MFI of standard curve samples.
Then, the prediction would require significant data extrapolation, which could lead to unreliable results.
In such cases, the nMFI values could be used as a proxy for RAU values if we want, for instance, to account for plate-to-plate variation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PvSTATEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/example_script.html">Basic PvSTATEM functionalities</a></li>
    <li><a class="dropdown-item" href="../articles/our_datasets.html">Our datasets</a></li>
    <li><a class="dropdown-item" href="../articles/our_plots.html">Introduction to plots created by our package</a></li>
    <li><a class="dropdown-item" href="../articles/our_reports.html">Overview of reports generated by PvSTATEM package</a></li>
    <li><a class="dropdown-item" href="../articles/parsers.html">Raw data parsers</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mini-pw/PvSTATEM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate normalised MFI values for a plate</h1>
      <small class="dont-index">Source: <a href="https://github.com/mini-pw/PvSTATEM/blob/v0.2.0/R/get-nmfi.R" class="external-link"><code>R/get-nmfi.R</code></a></small>
      <div class="d-none name"><code>get_nmfi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function calculates the normalised MFI (nMFI) values for each of the analytes in the plate.</p>
<p>The nMFI values are calculated as the ratio of the test samples' MFI values to the standard curve samples with the target dilution.</p>
<p><strong>When nMFI could be used?</strong>
In general, it is preferred to use Relative Antibody Unit (RAU) values for any analysis.
However, it is sometimes impossible to fit a model to the standard curve samples.
This may happen if the MFI values of test samples are much higher than the MFI of standard curve samples.
Then, the prediction would require significant data extrapolation, which could lead to unreliable results.</p>
<p>In such cases, the nMFI values could be used as a proxy for RAU values if we want, for instance, to account for plate-to-plate variation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_nmfi</span><span class="op">(</span></span>
<span>  <span class="va">plate</span>,</span>
<span>  reference_dilution <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">400</span>,</span>
<span>  data_type <span class="op">=</span> <span class="st">"Median"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-plate">plate<a class="anchor" aria-label="anchor" href="#arg-plate"></a></dt>
<dd><p>(<code><a href="Plate.html">Plate()</a></code>) a plate object for which to calculate the nMFI values</p></dd>


<dt id="arg-reference-dilution">reference_dilution<a class="anchor" aria-label="anchor" href="#arg-reference-dilution"></a></dt>
<dd><p>(<code>numeric(1) or character(1)</code>) the dilution value of the standard curve sample
to use as a reference for normalisation. The default is <code>1/400</code>.
It should refer to a dilution of a standard curve sample in the given plate object.
This parameter could be either a numeric value or a string.
In case it is a character string, it should have format <code>1/d+</code>, where <code>d+</code> is any positive integer.</p></dd>


<dt id="arg-data-type">data_type<a class="anchor" aria-label="anchor" href="#arg-data-type"></a></dt>
<dd><p>(<code>character(1)</code>) type of data for the computation. Median is the default</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>(<code>logical(1)</code>) print additional information. The default is <code>TRUE</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>nmfi (<code>data.frame</code>) a data frame with normalised MFI values for each analyte in the plate and all test samples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># read the plate</span></span></span>
<span class="r-in"><span><span class="va">plate_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT.csv"</span>, package <span class="op">=</span> <span class="st">"PvSTATEM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">layout_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT_layout.csv"</span>, package <span class="op">=</span> <span class="st">"PvSTATEM"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">plate</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_luminex_data.html">read_luminex_data</a></span><span class="op">(</span><span class="va">plate_file</span>, <span class="va">layout_file</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading Luminex data from: /home/runner/work/_temp/Library/PvSTATEM/extdata/CovidOISExPONTENT.csv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> using format xPONENT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">New plate object has been created with name: CovidOISExPONTENT!</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># artificially bump up the MFI values of the test samples (the Median data type is default one)</span></span></span>
<span class="r-in"><span><span class="va">plate</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="st">"Median"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">plate</span><span class="op">$</span><span class="va">sample_types</span> <span class="op">==</span> <span class="st">"TEST"</span>, <span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="va">plate</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="st">"Median"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">plate</span><span class="op">$</span><span class="va">sample_types</span> <span class="op">==</span> <span class="st">"TEST"</span>, <span class="op">]</span> <span class="op">*</span> <span class="fl">10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate the nMFI values</span></span></span>
<span class="r-in"><span><span class="va">nmfi</span> <span class="op">&lt;-</span> <span class="fu">get_nmfi</span><span class="op">(</span><span class="va">plate</span>, reference_dilution <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">400</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we don't do any extrapolation and the values should be comparable across plates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nmfi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Spike_6P       ME    HKU1_S   OC43_NP    OC43_S   HKU1_NP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-226-01-CF 58.42408 19.88889  3.821903 15.449180 24.537445 10.957643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-263-02-KC 71.71064 14.71111 26.996681 13.481967 30.638767 11.694291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-080-02-TV 71.69239 20.24444 46.227876  6.085246 37.077827  9.410681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-215-01-BA 75.86304 32.88889 21.028761  3.816393  4.919236  6.841621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-H-SD-039-BC 36.95481 10.37778 14.778761  4.393443  3.340675  6.942910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-H-RD-053-MO 38.48162 23.86667 10.199115  9.718033  8.076358 10.101289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 X229E_NP Mumps_NP RBD_B16171   NL63_NP RBD_B16172 RBD_wuhan</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-226-01-CF 21.180070 35.59322   256.1207 19.691092   218.1206  85.17229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-263-02-KC  5.576923 14.27966   322.8017  2.916667   271.6690  96.59775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-080-02-TV 20.611888 25.63559   363.6422  9.741379   289.6494 101.05912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-215-01-BA  8.933566 50.29661   426.0991  6.163793   322.8050 108.53827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-H-SD-039-BC 10.236014 12.03390   104.3103 11.357759    83.0014  44.06239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-H-RD-053-MO 26.634615 77.54237   106.6810  4.245690   101.7952  46.88067</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  NL63_S    X229E_S Spike_B16172 Spike_B117 Measles_NP      Ade5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-226-01-CF 33.54772   4.740177     90.21091   64.61869  15.324675 27.419733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-263-02-KC 19.87552  25.095057     92.81379   73.76692  46.190476 16.766603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-080-02-TV 21.70124  52.769328    111.20885   78.75536  61.428571 23.827151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-215-01-BA 63.94191  39.201521    120.52984   87.87884  11.904762 21.306260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-H-SD-039-BC 14.48133  15.057034     50.00514   40.64048   4.891775 10.552705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-H-RD-053-MO 91.53527 125.614702     53.17387   43.51106  33.614719  8.969359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       NP Spike_P1      Rub     Ade40 RBD_B117 Spike_B1351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-226-01-CF 0.4600288 62.10091 61.03586 22.639035 223.4188    72.55825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-263-02-KC 0.3348938 67.04466 15.25327 37.208814 262.2906    72.53495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-080-02-TV 1.0694995 81.00914 27.53557 73.415530 275.6239    93.80009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-215-01-BA 1.3449766 87.09564 16.49402 29.412382 320.6667   105.24697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-H-SD-039-BC 0.5014404 34.12799 12.53273 13.300105 101.7094    40.24231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-H-RD-053-MO 4.0115232 40.63291 26.08423  5.146905 104.9573    41.37465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     FluA RBD_B1351   RBD_P15       S2 Spike_omicron RBD_omicron</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-226-01-CF 20.279330 369.71429 286.56780 56.53736     210.01021   317.16981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-263-02-KC 89.208566 422.35714 344.83051 45.80460     260.78652   410.80189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-080-02-TV 30.633147 562.35714 390.42373 87.06897     301.92033   453.18396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-F-215-01-BA 63.431099 685.10714 499.11017 90.22989     369.75485   524.05660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-H-SD-039-BC  7.295158  80.64286  63.77119 29.26724      63.61593    65.14151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CO-H-RD-053-MO 53.580074 150.85714 117.52119 33.18966      90.27579   102.26415</span>
<span class="r-in"><span><span class="co"># different params</span></span></span>
<span class="r-in"><span><span class="va">nmfi</span> <span class="op">&lt;-</span> <span class="fu">get_nmfi</span><span class="op">(</span><span class="va">plate</span>, reference_dilution <span class="op">=</span> <span class="st">"1/50"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tymoteusz Kwiecinski, Jakub Grzywaczewski, Mateusz Nizwantowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

